<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Taylor Arnold and Lauren Tilton">

<title>2&nbsp; EDA I: Visualizing Data – Humanities Data in Python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03_verbs.html" rel="next">
<link href="./01_intro.html" rel="prev">
<link href="./owl_explore.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-7dd7401653f9b7f7a674e3bd3661a20e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01_intro.html">Part I: Core</a></li><li class="breadcrumb-item"><a href="./02_graphics.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">EDA I: Visualizing Data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Humanities Data in Python</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/distant-viewing/hdpy" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part I: Core</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_graphics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">EDA I: Visualizing Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_verbs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">EDA II: Organizing Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_combine.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">EDA III: Restructuring Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_collect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Collecting Data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part II: Data Types</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_textual_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Textual Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_network_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Network Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_temporal_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Temporal Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_spatial_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Spatial Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_image_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Image Data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part III: Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_supervised.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Supervised Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_unsupervised.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Unsupervised Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_deeplearning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Deep Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_transformers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Transformers</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part IV: Programming</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_program.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17_jsonxml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">JSON + XML</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18_databases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Databases</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">2.1</span> Introduction</a></li>
  <li><a href="#text-geometry" id="toc-text-geometry" class="nav-link" data-scroll-target="#text-geometry"><span class="header-section-number">2.2</span> Text Geometry</a></li>
  <li><a href="#lines-and-bars" id="toc-lines-and-bars" class="nav-link" data-scroll-target="#lines-and-bars"><span class="header-section-number">2.3</span> Lines and Bars</a></li>
  <li><a href="#optional-aesthetics" id="toc-optional-aesthetics" class="nav-link" data-scroll-target="#optional-aesthetics"><span class="header-section-number">2.4</span> Optional Aesthetics</a></li>
  <li><a href="#scales" id="toc-scales" class="nav-link" data-scroll-target="#scales"><span class="header-section-number">2.5</span> Scales</a></li>
  <li><a href="#labels-and-themes" id="toc-labels-and-themes" class="nav-link" data-scroll-target="#labels-and-themes"><span class="header-section-number">2.6</span> Labels and Themes</a></li>
  <li><a href="#conventions-for-graphics-code" id="toc-conventions-for-graphics-code" class="nav-link" data-scroll-target="#conventions-for-graphics-code"><span class="header-section-number">2.7</span> Conventions for Graphics Code</a></li>
  <li><a href="#extensions" id="toc-extensions" class="nav-link" data-scroll-target="#extensions"><span class="header-section-number">2.8</span> Extensions</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01_intro.html">Part I: Core</a></li><li class="breadcrumb-item"><a href="./02_graphics.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">EDA I: Visualizing Data</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-ch02" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">EDA I: Visualizing Data</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">2.1</span> Introduction</h2>
<p>As we outlined in Chapter 1, the concept of exploratory data analysis (EDA) is key to our approach. As a result, data visualization is one of the most important tasks and powerful tools for the analysis of data. We start our study of exploratory data analysis with visualization because it offers the best immediate payoff for how statistical programming can help understand datasets of any size. Visualizations also have the benefit for those new to programming because it is relatively easy to verify that our code is working. We can just look at the output and see if the resulting plot is what we expected. Finally, data visualizations can be useful for even very small collections of data.</p>
<p>In this chapter, we will learn and use the <strong>plotnine</strong> package for building informative graphics <span class="citation" data-cites="plotnine">[<a href="#ref-plotnine" role="doc-biblioref">1</a>]</span> <span class="citation" data-cites="wilkinson2012grammar">[<a href="#ref-wilkinson2012grammar" role="doc-biblioref">2</a>]</span>. The package makes it easy to build fairly complex graphics in a way that is guided by a general theory of data visualization. The only downside is that, because it is built around a theoretical model rather than many one-off solutions for different tasks, it has a somewhat steeper initial learning curve. The chapter is designed to get us started using the package to make a variety of different data visualizations.</p>
<p>The core idea of the grammar of graphics is that visualizations are composed of independent <em>layers</em>. The term “grammar” is used to describe visualizations because the theory builds connections between elements of the dataset to elements of a visualization. It builds up complex elements from smaller ones, much like a grammar provides relations between words in order to generate larger phrases and sentences. To describe a specific layer, we need to specify several elements. First, we need to specify the dataset from which data will be taken to construct the plot. Next, we have to specify a set of mappings called <em>aesthetics</em> that describe how elements of the plot are related to columns in our data. For example, we often indicate which column corresponds to the horizontal axis of the plot and which one corresponds to the vertical axis of the plot. It is also possible to describe elements such as color, shape, and size of elements of the plot by associating these quantities with columns in the data. Finally, we need to provide the <em>geometry</em> that will be used in the plot. The geometry describes the kinds of objects that are associated with each row of the data. A common example is the points geometry, which associates a single point with each observation.</p>
<p>We can show how to use the grammar of graphics by starting with the CBSA data that we introduced in the previous chapter, where each row is associated with a particular metropolitan region in the United States. The first plot we will make is a scatter plot that investigates the relationship between the median price of a one-bedroom apartment and the population density of the metropolitan region. In the language of the grammar of graphics, we can start to describe this visualization by providing the variable name in Python of the data (<code>cbsa</code>). Next, we associate the horizontal axis (called the <code>x</code> aesthetic) with the column in the data named <code>density</code>. The vertical axis (the <code>y</code> aesthetic) can similarly be associated with the column named <code>rent_1br_median</code>. We will make a scatter plot, with each point on the plot describing one of our metropolitan regions, which leads us to use a <em>point geometry</em>. Our plot will allow us to understand the relationship between city density and rental prices.</p>
<div id="fig-img-ggplot" class="lightbox quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-img-ggplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="img/diagram_ggplot.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;2.1: Diagram of how the elements of the grammar of graphics correspond to elements of the code and visualization."><img src="img/diagram_ggplot.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-img-ggplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.1: Diagram of how the elements of the grammar of graphics correspond to elements of the code and visualization.
</figcaption>
</figure>
</div>
<p>In Python, we need to use some special functions to indicate all of this information and to instruct the program to produce a plot. We start by indicating the name of the underlying dataset and using it to create a special object called <code>ggplot</code> that indicates that we want to create a data visualization. The plot itself is created by adding—literally, with the plus sign—the function <code>geom_point</code>. This function indicates that we want to add a points geometry to the plot. Inside of the geometry function, we apply the function <code>aes</code> (short for aesthetics), which indicates that we want to specify the mappings between components of the plot and column names in our dataset. Code to write this using the values described in the previous paragraph is given below.</p>
<div id="387655e8" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(ggplot(cbsa) <span class="op">+</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    geom_point(aes(x<span class="op">=</span><span class="st">'density'</span>, y<span class="op">=</span><span class="st">'rent_1br_median'</span>)))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>cbsa[[<span class="st">'name'</span>, <span class="st">'quad'</span>, <span class="st">'density'</span>, <span class="st">'rent_1br_median'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">quad</th>
<th data-quarto-table-cell-role="th">density</th>
<th data-quarto-table-cell-role="th">rent_1br_median</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>New York</td>
<td>NE</td>
<td>1051.306467</td>
<td>1430</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Los Angeles</td>
<td>W</td>
<td>1040.647281</td>
<td>1468</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Chicago</td>
<td>NC</td>
<td>508.629406</td>
<td>1060</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Dallas</td>
<td>S</td>
<td>323.181404</td>
<td>1106</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Houston</td>
<td>S</td>
<td>316.543514</td>
<td>997</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Washington</td>
<td>S</td>
<td>363.732689</td>
<td>1601</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Philadelphia</td>
<td>NE</td>
<td>506.068130</td>
<td>1083</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Miami</td>
<td>S</td>
<td>430.103162</td>
<td>1230</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Atlanta</td>
<td>S</td>
<td>263.275821</td>
<td>1181</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Boston</td>
<td>NE</td>
<td>517.827702</td>
<td>1390</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>Phoenix</td>
<td>W</td>
<td>126.558955</td>
<td>1065</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>San Francisco</td>
<td>W</td>
<td>712.992772</td>
<td>1940</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Riverside</td>
<td>W</td>
<td>64.511974</td>
<td>1120</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>Detroit</td>
<td>NC</td>
<td>421.567420</td>
<td>811</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>Seattle</td>
<td>W</td>
<td>256.189989</td>
<td>1478</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>Minneapolis</td>
<td>NC</td>
<td>188.297448</td>
<td>1035</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>San Diego</td>
<td>W</td>
<td>298.781488</td>
<td>1518</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>Tampa</td>
<td>S</td>
<td>452.790117</td>
<td>1045</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>Denver</td>
<td>W</td>
<td>135.070927</td>
<td>1340</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>Baltimore</td>
<td>S</td>
<td>404.661335</td>
<td>1132</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>St. Louis</td>
<td>NC</td>
<td>134.615515</td>
<td>778</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>Orlando</td>
<td>S</td>
<td>253.043039</td>
<td>1156</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>Charlotte</td>
<td>S</td>
<td>177.393426</td>
<td>1074</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>San Antonio</td>
<td>S</td>
<td>132.337510</td>
<td>936</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>Portland</td>
<td>W</td>
<td>141.406821</td>
<td>1262</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>Sacramento</td>
<td>W</td>
<td>173.268846</td>
<td>1156</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>Pittsburgh</td>
<td>NE</td>
<td>171.198592</td>
<td>743</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>Cincinnati</td>
<td>NC</td>
<td>187.276368</td>
<td>714</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>Austin</td>
<td>S</td>
<td>201.447732</td>
<td>1216</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>Las Vegas</td>
<td>W</td>
<td>106.878725</td>
<td>1004</td>
</tr>
</tbody>
</table>

</div>
<p>Plot of the largest 30 core-based statistical areas in the United States, showing their density and the median price to rent a one-bedroom apartment from the 2021 American community survey.</p>
</div>
</div>
<p>Running the code above from a Quarto document will show the desired visualization right below the block of code. In this plot, each row of our dataset, a CBSA region, is represented as a point in the plot. The location of each point is determined by the density and median rent price for a one-bedroom apartment in the corresponding region. Notice that Python has automatically made several choices for the plot that we did not explicitly indicate in the code. For example, the range of values on the two axes, the axis labels, the grid lines, and the marks along the grid. Python has also automatically picked the color, size, and shape of the points. While the defaults work as a good starting point, it is often useful to modify these values; we will see how to changes these aspects of the plot in later sections of this chapter.</p>
<p>Scatter plots are typically used to understand the relationship between two numeric values. What does our first plot tell us about the relationship between city density and median rent? There is not a clear trend between these two variables. Rather, the plot of these two economic metrics clusters the regions into several groups. We see a couple of regions with a very high density but only moderately large rental prices, one city with unusually high rental prices, and the rest of the regions fairly uniformly distributed in the lower-left corner of the plot. Let’s see if we can give some more context to the plot by adding additional information.</p>
</section>
<section id="text-geometry" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="text-geometry"><span class="header-section-number">2.2</span> Text Geometry</h2>
<p>A common critique of computational methods is that they obscure a closer understanding of each individual object of study in an attempt to search for numeric patterns. This is certainly an important caution; computational analysis of humanities data should always be paired with close analysis. However, it does not always have to be the case that visualizations reduce complex collections to a few numerical summaries. This is particularly so when working with a dataset that has a relatively small number of observations. Looking back at our first scatter plot, how could we recover a closer analysis of individual cities while also looking for general patterns between the two economic variables? One option is to add labels indicating the names of the regions. These names would let anyone looking at the plot to adding their own understanding of the individual regions as an additional layer of information as they interpret the plot.</p>
<p>Adding the names of the regions can be done by using another type of geometry called a <em>text geometry</em>. This geometry is created with the function <code>geom_text</code>. For each row of a given dataset, this geometry adds a small textual label. As with the point geometry, it requires us to specify which columns of our data correspond to the <code>x</code> and <code>y</code> aesthetics. These values tell the plot where to place the label. Additionally, the text geometry requires an aesthetic called <code>label</code> that indicates the column of the dataset that the label should take its text from. In our case, we will use the column called <code>name</code> to make textual labels on the plot. A reminder that this is a column name from the data that we loaded in. The code block below produces a text label plot by changing the geometry type and adding the additional aesthetic from the previous example.</p>
<div id="8ed3c496" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(ggplot(cbsa) <span class="op">+</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    geom_text(aes(x<span class="op">=</span><span class="st">'density'</span>, y<span class="op">=</span><span class="st">'rent_1br_median'</span>, label<span class="op">=</span><span class="st">'name'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_graphics_files/figure-html/cell-4-output-1.png" width="672" height="480" class="figure-img"></p>
<figcaption>Plot of the largest 30 core-based statistical areas in the United States, showing their density and the median price to rent a one-bedroom apartment from the 2021 American Community Survey. Here, short descriptive names of the regions are included.</figcaption>
</figure>
</div>
</div>
</div>
<p>The plot generated by the code allows us to now see which region has the highest rents (San Francisco). And, we can identify which regions have the highest density (New York and Los Angeles). We can also identify regions such as Detroit that are relatively dense but inexpensive or regions such as Denver that are not particularly dense but still one of the more expensive regions to rent in. While we have added only a single additional piece of information to the plot, each of the labels uniquely identifies each row of the data. This allows anyone familiar with metropolitan regions in the United States to bring many more characteristics of each data point to the plot through their own knowledge. For example, while the plot does not include any information about overall population, anyone who knows the largest cities in the US can use the plot to see that the two most dense cities (New York and Los Angeles) are also the most populous. And, while the plot does not have information about the location of the regions, if we know the general geography of the country, it is possible to see that many of the cities that are expensive but not particularly dense (Portland, Denver, Seattle, and San Diego) are on the West Coast. These observations point to the power of including labels on a scatter plot.</p>
<p>While the text plot adds additional contextual information compared to the scatter plot, it does have some shortcomings. Some of the labels for points at the edges of the plot fall off and become truncated. Labels for points in the lower-left corner of the plot start to overlap one another and become difficult to read. These issues will only grow if we increase the number of regions in our dataset. Also, it is not entirely clear what part of the label corresponds to the density of the cities. Is it the center of the label, the start of the label, or the end of the label? We could add a note that the value is the center of the label, but that becomes somewhat cumbersome to have to constantly remember and remind ourselves and others about.</p>
<p>To start addressing these issues, we can add the points back into the plot with the labels. We could do this in Python by adding the two geometry layers (<code>geom_point</code> and <code>geom_text</code>) one after the other. This will make it more clear where on the x-axis each region is associated to, but at the same time will make the names of the cities even more difficult to read. To fix the second problem, we will replace the text geometry with a different geometry called <code>geom_text_repel</code>. It also places labels on the plot, but has special logic that avoids intersecting labels. Instead, labels are moved away from the data points and connected (when needed) by a line segment. As with the text geometry, the text repel geometry requires specifying <code>x</code>, <code>y</code>, and <code>label</code> aesthetics. Below is the code to make both of these modifications.</p>
<div id="68f64c8e" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> adjustText <span class="im">import</span> adjust_text</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: plotnine doesn't have geom_text_repel, so we'll use a workaround with regular geom_text</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># For production code, you might want to use matplotlib directly or another solution</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>(ggplot(cbsa) <span class="op">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    geom_point(aes(x<span class="op">=</span><span class="st">'density'</span>, y<span class="op">=</span><span class="st">'rent_1br_median'</span>)) <span class="op">+</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    geom_text(aes(x<span class="op">=</span><span class="st">'density'</span>, y<span class="op">=</span><span class="st">'rent_1br_median'</span>, label<span class="op">=</span><span class="st">'name'</span>), </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>              nudge_y<span class="op">=</span><span class="dv">50</span>, size<span class="op">=</span><span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_graphics_files/figure-html/cell-5-output-1.png" width="672" height="480" class="figure-img"></p>
<figcaption>Plot of the largest 30 core-based statistical areas in the United States, showing their density and the median price to rent a one-bedroom apartment from the 2021 American community survey. Here, short descriptive names of the regions are included but offset from the points to make the plot easier to read.</figcaption>
</figure>
</div>
</div>
</div>
<p>The output of the plot with the points and text labels shows that we have attempted to avoid writing labels that intersect one another by nudging them slightly. The points indicate the specific values of the density and median rents, while the labels provide context about which metropolitan area each point represents. Some of the labels do still become a bit busy in the lower left-hand corner; this could be fixed by making the size of the labels slightly smaller, which we will learn how to do later in the chapter. Once the number of points becomes larger, it will eventually not be possible to label all of the points. Several strategies exist for dealing with this, such as only labeling a subset of the points. We will see these techniques as they arise in our examples. The <strong>plotnine</strong> package and communities online have an entire ecosystem of strategies for increasing interpretability and adding context to plot, providing strategies for using the exploratory and visual power of data visualization to garner insights from humanities data.</p>
</section>
<section id="lines-and-bars" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="lines-and-bars"><span class="header-section-number">2.3</span> Lines and Bars</h2>
<p>There a large number of different geometries supplied by the <strong>plotnine</strong> package, in addition to the even larger collection of extensions by other Python packages. We will look at two other types of geometries in this section that allow us to investigate common relationships in the columns of a dataset. Other geometries will be discussed throughout the book as the need arises, and the full list of geometries can be found in the <strong>plotnine</strong> package’s documentation.</p>
<div id="fig-img-geoms" class="lightbox quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-img-geoms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="img/diagram_geoms.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2.2: Examples of common geometries used in the grammar of graphics."><img src="img/diagram_geoms.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-img-geoms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.2: Examples of common geometries used in the grammar of graphics.
</figcaption>
</figure>
</div>
<p>For a moment, we will switch gears and look at the food prices dataset, which was introduced in the previous chapter. This data contains one row for every year from 1870 through 2015, with relative prices for thirteen different food items across the United States <span class="citation" data-cites="ch02:jacks2019boom">[<a href="#ref-ch02:jacks2019boom" role="doc-biblioref">3</a>]</span>. Consider a visualization showing the change in the price of tea over the 146 years in the dataset. We could create a scatter plot where each point is a row of the data, the <code>x</code> aesthetic captures the year of each record, and the <code>y</code> aesthetic measures the relative cost of tea. This visualization would be fine and could roughly help us understand the changes in relative prices for this commodity. A common visualization type, however, for data of this format is a line plot, where the price in each year is connected by a line to the price in the subsequent year. To create such a plot, we can use the <code>geom_line</code> geometry. This is most commonly used when the horizontal axis measures some unit of time, but can represent other quantities that we expect to continuously and smoothly change between measurements on the x-axis. The line geometry requires the same aesthetics as the point geometry and can be created with the same syntax, as shown in the following block of code.</p>
<div id="8f3e18cd" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>(ggplot(food_prices) <span class="op">+</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    geom_line(aes(x<span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'tea'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_graphics_files/figure-html/cell-6-output-1.png" width="672" height="480" class="figure-img"></p>
<figcaption>Plot of the price of tea in standardized units (100 is the price in 1900) over time.</figcaption>
</figure>
</div>
</div>
</div>
<p>The output of this visualization allows us to see the change over time of the tea prices. Notice that the relative price decreased fairly steadily from 1870 through to 1920. It had a few sudden drops and reversals in the 1920s and 1930s, before increasing again in the 1950s. The relative cost of tea then decreased again fairly steadily from the mid 1950s through to the end of the data range in 2015.</p>
<p>Another common usage of a visualization is to see the value of a numeric column of the dataset relative to a character column of the dataset. It is possible to represent such a relationship with a <code>geom_point</code> layer. However, it is often more visually meaningful to use a bar for each category and the height or length of the bar representing the numeric value. This type of plot is most common when showing the counts of different categories, something we will see in the next chapter, but can also be used in any situation where a numeric value is associated with different categories. To create a plot with bars we use the <code>geom_col</code> function, providing both <code>x</code> and <code>y</code> aesthetics. Python will automatically create vertical bars if we have a character variable associated with the <code>x</code> aesthetic and horizontal bars if we have one in the <code>y</code> aesthetic. Putting the character variable on the y-axis usually makes it easier to read the labels, so we recommend it in most cases. In the code block below, we have the commands to create a bar plot of the population in each region from the CBSA dataset.</p>
<div id="b0263dbc" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(ggplot(cbsa) <span class="op">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    geom_col(aes(x<span class="op">=</span><span class="st">'pop'</span>, y<span class="op">=</span><span class="st">'name'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_graphics_files/figure-html/cell-7-output-1.png" width="672" height="480" class="figure-img"></p>
<figcaption>Plot of the population of the largest 30 core-based statistical areas in the United States, showing their population from the 2021 American community survey.</figcaption>
</figure>
</div>
</div>
</div>
<p>One of the first things that stands out in the output is that the regions are ordered alphabetically from bottom to top. The visualization would be much more useful and readable if we could reorder the categories on the y-axis. This is also something that we will address in the following chapter. For now, we can see how <strong>plotnine</strong> is offering a range of plot types to see our data from different angles. We can add additional context through additional aesthetics.</p>
</section>
<section id="optional-aesthetics" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="optional-aesthetics"><span class="header-section-number">2.4</span> Optional Aesthetics</h2>
<p>In the previous sections, we have shown how visualizations can be built out of geometry layers, where each geometry is associated with a dataset and a collection of variable mappings known as aesthetics. The point, line, and bar geometries require <code>x</code> and <code>y</code> aesthetics; the text geometry also required an aesthetic named <code>label</code>. In addition to the required aesthetics, each geometry type also has a number of optional aesthetics that we can use to add additional information to the plot. For example, most geometries have a <code>color</code> aesthetic. The syntax for describing this is exactly the same as with the required aesthetics: we place the name of the aesthetic followed by the name of the associated variable name. Let’s see what happens when we add a color aesthetic to our scatter plot by relating the column called <code>quad</code> to the aesthetic named <code>color</code>. Below is the corresponding code.</p>
<div id="298b93aa" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(ggplot(cbsa) <span class="op">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    geom_point(aes(x<span class="op">=</span><span class="st">'density'</span>, y<span class="op">=</span><span class="st">'rent_1br_median'</span>, color<span class="op">=</span><span class="st">'quad'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_graphics_files/figure-html/cell-8-output-1.png" width="672" height="480" class="figure-img"></p>
<figcaption>Plot of the largest 30 core-based statistical areas in the United States, showing their density and the median price to rent a one-bedroom apartment from the 2021 American community survey. Here, the points are colored based on the quadrant in which the city is found in the United States.</figcaption>
</figure>
</div>
</div>
</div>
<p>The result of associating a column in the dataset with a color produces a new variation of the original scatter plot. We have the same set of points and locations on the plot, as well as the same axes. However, now each color has been automatically associated with a region and every point has been colored according to the region column associated with each row of the data. The mapping between colors and region names is shown in an automatically created legend on the right-hand side of the plot. The ability to add additional information to the plot by specifying a single aesthetic speaks to how powerful the grammar of graphics is in terms of quickly producing informative visualizations of data. In the first edition of this text, which used the built-in graphics system in Python, it was necessary to write nearly a dozen lines of code to produce a similar plot. Now that we are able to use the <strong>plotnine</strong> package, this process has been greatly simplified.</p>
<p>In the previous example we changed the color aesthetic from the fixed default of black to a color that changes with another variable. It is also possible to specify an alternative, fixed value for any aesthetic. We can draw on the color names available in Python. For example, we might want to change all of the points to be a shade of green. This can be done with a small change to the function call. To do this, we set the color aesthetic to the name of a color, such as “red”. However, unlike with variable aesthetics, the mapping needs to be done outside of the <code>aes()</code> function, but still within the <code>geom_*</code> function. Below is an example of the code to redo our plot with a different color; we use a color called “olivedrab”, which in print is much more aesthetically pleasing than its name might at first suggest.</p>
<div id="34dd828f" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(ggplot(cbsa) <span class="op">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    geom_point(aes(x<span class="op">=</span><span class="st">'density'</span>, y<span class="op">=</span><span class="st">'rent_1br_median'</span>), color<span class="op">=</span><span class="st">'olivedrab'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_graphics_files/figure-html/cell-9-output-1.png" width="672" height="480" class="figure-img"></p>
<figcaption>Plot of the largest 30 core-based statistical areas in the United States, showing their density and the median price to rent a one-bedroom apartment from the 2021 American community survey. The color of the points has been changed to a dark green called ‘olivedrab’.</figcaption>
</figure>
</div>
</div>
</div>
<p>While minor, the changed notation for specifying fixed aesthetics is a common source of confusing errors for users new to the geometry of graphics, so be careful to follow the correct syntax of arguments as in the code above. One can interchange the fixed and variable aesthetic commands, and the relative order should not effect the output. Just be sure to put fixed terms after finishing the <code>aes()</code> command.</p>
<p>While each geometry can have different required and optional aesthetics, the <strong>plotnine</strong> package tries as much as possible to use a common set of terms for the aesthetics in each geometry. We have already seen the <code>x</code>, <code>y</code>, and <code>label</code> aesthetics in the previous sections, and just introduced the <code>color</code> aesthetic. Color can also be used to change the color of a line plot or the color of the font in a text geometry. For applications such as the bar plot, we might want to modify both the border and interior colors of the bars; these are set separately by the <code>color</code> and <code>fill</code> aesthetics, respectively. The <code>size</code> aesthetic can be used to set the size of the points in a scatter plot or the font-size of the labels in a text geometry. The <code>shape</code> aesthetic is used to modify the shape of the points. An aesthetic named <code>alpha</code> controls the opacity of points, with a value of 1 being the default and 0 being completely invisible. Some of these, such as <code>alpha</code>, are most frequently used with fixed values, but if needed, almost all can be given a variable mapping as well.</p>
</section>
<section id="scales" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="scales"><span class="header-section-number">2.5</span> Scales</h2>
<p>Python makes many choices for us automatically when creating any plot. In our example above, in which we set the color of the points to follow another variable in the dataset, Python handles the details of how to pick the specific colors and sizes. It has figured how large to make the axes, where to add tick marks, and where to draw grid lines. Letting Python deal with these details is convenient because it frees us up to focus on the data itself. Sometimes, such as when preparing to produce plots for external distribution, or when the default are particularly hard to interpret, it is useful to manually adjust these details. This is exactly what scales were designed for.</p>
<p>Each aesthetic within the grammar of graphics is associated with a scale. Scales detail how a plot should relate aesthetics to the concrete, perceivable features in a plot. For example, a scale for the <code>x</code> aesthetic will describe the smallest and largest values on the x-axis. It will also code information about how to label the x-axis. Similarly, a color scale describes what colors corresponds to each category in a dataset and how to format a legend for the plot. In order to change or modify the default scales, we add an additional function to the code. The order of the scales relative to the geometries do not effect the output; by convention, scales are usually grouped after the geometries.</p>
<p>For example, a popular alternative to the default color palette shown in our previous plot is the function <code>scale_color_cmap_d()</code>. It constructs a set of colors that is color-blind friendly, looks nice when printed in black and white, and displays fine on bad projectors. After specifying that the color of a geometry should vary with a column in the dataset, we specify this color scale by adding the function as an extra line in the plot. An example is shown in the following code.</p>
<div id="5c4eeda5" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(ggplot(cbsa) <span class="op">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    geom_point(aes(x<span class="op">=</span><span class="st">'density'</span>, y<span class="op">=</span><span class="st">'rent_1br_median'</span>, color<span class="op">=</span><span class="st">'quad'</span>)) <span class="op">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    scale_color_cmap_d())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_graphics_files/figure-html/cell-10-output-1.png" width="672" height="480" class="figure-img"></p>
<figcaption>Plot of the largest 30 core-based statistical areas in the United States, showing their density and the median price to rent a one-bedroom apartment from the 2021 American community survey. Here, the points color based on the quadrant in which the city is found in the United States, with a color-blind friendly color scale.</figcaption>
</figure>
</div>
</div>
</div>
<p>The output shows that the colors are now given by a range from dark purple to bright yellow in place of the rainbow of colors in the default plot. As with the categories in the bar plot, the ordering of the unique colors is given by putting the categories in alphabetical order. Changing this requires modifying the dataset before passing it to the plot, something that we will discuss in the next chapter. Note that the <code>_d</code> at the end of the scale function indicates that the colors are used to create a set of mappings for a character variable (it stands for “discrete”). There is also a complimentary function <code>scale_color_cmap()</code> that produces a similar set of colors when making the color of the points change according to a numeric variable. The code below demonstrates the continuous case, where the population is treated as a numeric variable.</p>
<div id="7196dfff" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(ggplot(cbsa) <span class="op">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    geom_point(aes(x<span class="op">=</span><span class="st">'density'</span>, y<span class="op">=</span><span class="st">'rent_1br_median'</span>, color<span class="op">=</span><span class="st">'pop'</span>)) <span class="op">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    scale_color_cmap())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Many other scales exist to control a variety of aesthetics. For example, <code>scale_size_area</code> can be used to make the size of the points proportional to one of the other columns in a dataset. There are also several scales to control the x and y axes. For example, we can add <code>scale_x_log10()</code> and <code>scale_y_log10()</code> to a plot to produce values on a logarithmic scale, which can be very useful when working with heavily skewed datasets. We will use this in later chapters as needed.</p>
<p>The default scale for the x-axis is called <code>scale_x_continuous</code>. A corresponding function <code>scale_y_continuous</code> is the default for the y-axis. Adding these to a plot on their own has no visible effect. However, there are many helpful optional arguments that we can provide to these functions that change the way a plot is displayed. Setting <code>breaks</code> within one of these scales tells Python the number of labels to put on the axis. Also, making <code>minor_breaks</code> equal to <code>None</code> turns off the minor grid lines. We can set the value <code>limits</code> to a pair of numbers in order to describe the starting and ending range on a plot. Below is the code to produce a plot which shows the same data as our original scatter plot, but now with modified grid lines, axis labels, and vertical range.</p>
<div id="b5ed4605" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(ggplot(cbsa) <span class="op">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    geom_point(aes(x<span class="op">=</span><span class="st">'density'</span>, y<span class="op">=</span><span class="st">'rent_1br_median'</span>)) <span class="op">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    scale_x_continuous(breaks<span class="op">=</span>np.arange(<span class="dv">0</span>, <span class="dv">25000</span>, <span class="dv">2500</span>), minor_breaks<span class="op">=</span><span class="va">None</span>) <span class="op">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    scale_y_continuous(limits<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">2000</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_graphics_files/figure-html/cell-12-output-1.png" width="672" height="480" class="figure-img"></p>
<figcaption>Plot of the largest 30 core-based statistical areas in the United States, showing their density and the median price to rent a one-bedroom apartment from the 2021 American community survey. Here, we adjust the standard breaks and limits on the x- and y-axes.</figcaption>
</figure>
</div>
</div>
</div>
<p>Finally, there are two special scale types that can be useful for working with colors. In some cases we may already have a column in our dataset that explicitly describes the color of an observation; here, it would make sense to use these colors directly. To do that, we can add the scale <code>scale_color_identity</code> to the plot. Another type of scale that can be useful for colors is <code>scale_color_manual</code>. Here, it is possible to describe exactly which color should be used for each category. Below is the syntax for producing manually defined colors for each region in the CBSA dataset.</p>
<div id="92e63fd1" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(ggplot(cbsa) <span class="op">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    geom_point(aes(x<span class="op">=</span><span class="st">'density'</span>, y<span class="op">=</span><span class="st">'rent_1br_median'</span>, color<span class="op">=</span><span class="st">'quad'</span>)) <span class="op">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    scale_color_manual(values<span class="op">=</span>{</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'NC'</span>: <span class="st">'lightblue'</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'NE'</span>: <span class="st">'navy'</span>, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'S'</span>: <span class="st">'peachpuff'</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'W'</span>: <span class="st">'wheat'</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    }))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using manual colors is generally advisable in the case where there are well-known colors associated with the groups in the dataset. For example, when plotting data about political parties it may be helpful to use the colors traditionally associated with each party. The documentation for <strong>plotnine</strong> includes additional ways to customize visualizations using a variety of alternative scales.</p>
</section>
<section id="labels-and-themes" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="labels-and-themes"><span class="header-section-number">2.6</span> Labels and Themes</h2>
<p>Throughout this chapter, we have seen a number of ways to create and modify data visualizations. One thing that we did not cover was how to label our axes. While many data visualization guides often stress the importance of labeling axes, it is often best to simply use the default labels provided by Python during the exploratory phase of analysis. These are useful for a number of reasons. First, they require minimal effort and make it easy to tweak axes, variables, and other settings without spending time tweaking with the labels. Secondly, the default labels use the variable names in our dataset. When writing code this is exactly what we need to know about a variable to use it in additional plots, models, and data manipulation tasks. Of course, once we want to present our results to others, it is essential to provide more detailed descriptions of the axes and legends in our plot. Fortunately, these can be added directly using the grammar of graphics.</p>
<p>In order to change the labels in a plot, we can use the <code>labs</code> function as an extra part of our plot. Inside the function, we assign labels to the names of aesthetic values that we want to describe. Leaving a value unspecified will keep the default value in place. Labels for the x-axis and y-axis will be placed on the sides of the plot. Labels for other aesthetics such as size and color will be placed in the legend. We can also add <code>title</code>, <code>subtitle</code>, and a <code>caption</code> value to the <code>labs</code> command to add addition information to describe the plot as a whole. Here is an example of our scatter plot with color that includes a variety of different labels.</p>
<div id="f87e35c9" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>(ggplot(cbsa) <span class="op">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    geom_point(aes(x<span class="op">=</span><span class="st">'density'</span>, y<span class="op">=</span><span class="st">'rent_1br_median'</span>, color<span class="op">=</span><span class="st">'quad'</span>)) <span class="op">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    labs(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Density (people per km^2)'</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">'Median Rent, 1BD Apartment (USD)'</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'Quadrant'</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">'Relationship of CBSA Density and Housing Costs'</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        subtitle<span class="op">=</span><span class="st">'U.S. Core-based Statistical Areas'</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>        caption<span class="op">=</span><span class="st">'Data from the United States Census Bureau'</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_graphics_files/figure-html/cell-14-output-1.png" width="672" height="480" class="figure-img"></p>
<figcaption>Plot of the largest 30 core-based statistical areas in the United States, showing their density and the median price to rent a one-bedroom apartment from the 2021 American community survey. Here, we add custom labels and titles to the plot.</figcaption>
</figure>
</div>
</div>
</div>
<p>Another way to prepare our graphics for distribution is to modify the <em>theme</em> of a plot. Themes effect the way that the plot elements such as the axis labels, ticks, and background look. By default throughout this book, we have set the default plot to <code>theme_minimal</code>. We think that this is a great choice for the exploration of a dataset. As the name implies, it removes most of the clutter of other choices while keeping grid lines and other visual cues to help with interpretation. When presenting information for external publication, we often prefer to use a theme that is based on the work of Edward Tufte, a well-known scholar in the field of data visualization. To set the theme, we can add <code>theme_minimal()</code> or another theme function to our plot, as in the example below.</p>
<div id="67451fc6" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set minimal theme as default</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>theme_set(theme_minimal())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>&lt;plotnine.themes.theme_minimal.theme_minimal at 0x10b6cfe00&gt;</code></pre>
</div>
</div>
<p>Now, whenever we construct a plot it will use the newly assigned theme. Minimal themes are designed to use as little “ink” as possible, thus focusing the reader on the data <span class="citation" data-cites="tufte1987">[<a href="#ref-tufte1987" role="doc-biblioref">4</a>]</span>. They can be a bit too minimal when first exploring the dataset, but can be a great tool for presenting our results. Again, there are many resources online to customize according to our needs.</p>
</section>
<section id="conventions-for-graphics-code" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="conventions-for-graphics-code"><span class="header-section-number">2.7</span> Conventions for Graphics Code</h2>
<p>As a final point, note that there is a convention for simplifying the plotting command. Often, each layer will use the same x and y variables. It is possible to specify these just once in the <code>ggplot</code> function, and they will be used by default in all other layers. Also, we can drop the <code>x =</code> and <code>y =</code> if we put these options first. This can greatly simplify the amount of code needed to create a plot, therefore making the code easier to edit and understand. Below is an example of layering together the <code>geom_point</code> and <code>geom_text</code> with this inheritance structure.</p>
<div id="c4bc2474" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(ggplot(cbsa, aes(<span class="st">'density'</span>, <span class="st">'rent_1br_median'</span>)) <span class="op">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    geom_point() <span class="op">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    geom_text(aes(label<span class="op">=</span><span class="st">'name'</span>), nudge_y<span class="op">=</span><span class="dv">50</span>, size<span class="op">=</span><span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These changes are optional. It is perfectly fine to write them as we did earlier. It is important, though, to be able to recognize these conventions as we will make use of this convention throughout the rest of the book. We will also see this format when searching through documentation or help pages online. Finally, in the first chapter we stressed the importance of following a few style guidelines about our code. Here are three additional formatting rules that apply specifically to building graphics in Python:</p>
<ol type="1">
<li>indent the <code>ggplot</code> command by four spaces when inside parentheses</li>
<li>indent every line below <code>ggplot</code> by four spaces</li>
<li>always add each layer of a plot as a new line</li>
</ol>
<p>As with our original set of style guidelines, we think using these formatting rules will make life a lot easier. We will model their application in the code throughout the book.</p>
</section>
<section id="extensions" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="extensions"><span class="header-section-number">2.8</span> Extensions</h2>
<p>We have covered the most important elements—data, geometries, aesthetics, scales, themes—that make up data visualizations using the grammar of graphics as implemented in <strong>plotnine</strong>. At the end of Chap. 9, we will show how to make use of facets to show multiple plots next to one another. The three remaining elements are position, statistics, and coordinate systems. These are not as crucial to the basic usage of the grammar of graphics, but can be useful for more advanced applications or in specific situations where the defaults are not ideal. More details can be found in the <strong>plotnine</strong> documentation <span class="citation" data-cites="plotnine">[<a href="#ref-plotnine" role="doc-biblioref">1</a>]</span>. While we have covered the idea behind the main other elements, we have only shown a smaller number of the larger set of available geometries and scales.<br>
A full set can be found in the (continually updated) documentation pages and tutorials available online.</p>
<p>In addition to the programming aspects, there are many great references that can help inspire new approaches to data visualization. Classic and still very relevant references are Edward Tufte’s texts on data visualization <span class="citation" data-cites="tufte1987">[<a href="#ref-tufte1987" role="doc-biblioref">4</a>]</span> <span class="citation" data-cites="tufte1990">[<a href="#ref-tufte1990" role="doc-biblioref">5</a>]</span> <span class="citation" data-cites="tufte1997">[<a href="#ref-tufte1997" role="doc-biblioref">6</a>]</span> <span class="citation" data-cites="tufte2006">[<a href="#ref-tufte2006" role="doc-biblioref">7</a>]</span> <span class="citation" data-cites="tufte2020">[<a href="#ref-tufte2020" role="doc-biblioref">8</a>]</span>. Bremer and Wu’s <em>Data Sketches</em> provides a more in-depth study of several complex datasets and the kinds of modern, often interactive, visualizations they used to study them <span class="citation" data-cites="datasketches2021">[<a href="#ref-datasketches2021" role="doc-biblioref">9</a>]</span>. A more playful, but just as useful, take on data visualization is given in <em>Dear Data</em>, by Lupi and Posavec <span class="citation" data-cites="deardata2021">[<a href="#ref-deardata2021" role="doc-biblioref">10</a>]</span>. They show over one-hundred hand sketched data visualizations that were originally shared as postcards. These help imagine the possibilities that are not overly constrained to what is computationally easy to write. Finally, Cole Nussbaumer Knaflic’s <em>Storytelling with Data</em>, despite having a subtitle referencing business applications, provides a very humanistic approach to exploratory data analysis through visualizations along with a lot of useful and practical advice <span class="citation" data-cites="knaflic2015storytelling">[<a href="#ref-knaflic2015storytelling" role="doc-biblioref">11</a>]</span>. The field of data visualization is large and quickly growing. These are just a few examples that we have personally found to be useful references and sources of great practices and ideas.</p>
</section>
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">References</h2>


<div id="refs" class="references csl-bib-body" role="list">
<div id="ref-plotnine" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">Lavanya, A, Gaurav, L, Sindhuja, S, Seam, H, Joydeep, M, Uppalapati, V, Ali, W and SD, V S (2023 ). Assessing the performance of python data visualization libraries: A review. <em>Int. J. Comput. Eng. Res. Trends</em>. <strong>10</strong> 28–39</div>
</div>
<div id="ref-wilkinson2012grammar" class="csl-entry" role="listitem">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">Wilkinson, L (2012 ). <em>The Grammar of Graphics</em>. Springer</div>
</div>
<div id="ref-ch02:jacks2019boom" class="csl-entry" role="listitem">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">Jacks, D S (2019 ). From boom to bust: A typology of real commodity prices in the long run. <em>Cliometrica</em>. Springer. <strong>13</strong> 201–20</div>
</div>
<div id="ref-tufte1987" class="csl-entry" role="listitem">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">Tufte, E (1987 ). <em>The Visual Display of Quantitative Information</em>. Graphics Press</div>
</div>
<div id="ref-tufte1990" class="csl-entry" role="listitem">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">Tufte, E (1990 ). <em>Envisioning Information</em>. Graphics Press</div>
</div>
<div id="ref-tufte1997" class="csl-entry" role="listitem">
<div class="csl-left-margin">[6] </div><div class="csl-right-inline">Tufte, E (1997 ). <em>Visual Explanations: Images and Quantities, Evidence and Narrative</em>. Graphics Press</div>
</div>
<div id="ref-tufte2006" class="csl-entry" role="listitem">
<div class="csl-left-margin">[7] </div><div class="csl-right-inline">Tufte, E (2006 ). <em>Beautiful Evidence</em>. Graphics Press</div>
</div>
<div id="ref-tufte2020" class="csl-entry" role="listitem">
<div class="csl-left-margin">[8] </div><div class="csl-right-inline">Tufte, E (2020 ). <em>Seeing with Fresh Eyes: Meaning, Space, Data, Truth</em>. Graphics Press</div>
</div>
<div id="ref-datasketches2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">[9] </div><div class="csl-right-inline">Bremer, N and Wu, S (2021 ). <em>Data Sketches: A Journey of Imagination, Exploration, and Beautiful Data Visualizations</em>. CRC Press</div>
</div>
<div id="ref-deardata2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">[10] </div><div class="csl-right-inline">Lupi, G and Posavec, S (2016 ). <em>Dear Data</em>. CRC Press</div>
</div>
<div id="ref-knaflic2015storytelling" class="csl-entry" role="listitem">
<div class="csl-left-margin">[11] </div><div class="csl-right-inline">Knaflic, C N (2015 ). <em>Storytelling with Data: A Data Visualization Guide for Business Professionals</em>. John Wiley &amp; Sons</div>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/distant-viewing\.github\.io\/hdpy");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01_intro.html" class="pagination-link" aria-label="Introduction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03_verbs.html" class="pagination-link" aria-label="EDA II: Organizing Data">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">EDA II: Organizing Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Taylor Arnold and Lauren Tilton</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>A <a href="https://distantviewing.org/">Distant Viewing Lab</a> project</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>